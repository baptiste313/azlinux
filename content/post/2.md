---
title: Renforcez la sécurité de vos services web avec Cloudflare
slug: renforcez-la-securite-de-vos-services-web-avec-cloudflare
image: https://cdn.jsdelivr.net/gh/baptiste313/azlinux/v1/images/4734252/raw.webp
date: 2022-01-29T09:00:00+01:00
categories:
    - Cloudflare
    - Utilitaires
---

[![](https://shields.io/discord/935805859840290876?style=social&label=discord&logo=discord)](https://discord.gg/aThsHpfa7J)
[![](https://shields.io/github/stars/baptiste313/azlinux?style=social)](https://github.com/baptiste313/azlinux) 
[![](https://shields.io/youtube/channel/subscribers/UCv1Dfrx1Z1sF94s-d7M92Bw)](https://www.youtube.com/channel/UCv1Dfrx1Z1sF94s-d7M92Bw?sub_confirmation=1)

Si vous souhaitez rendre inaccessible l'accès aux connexions entrantes autre que Cloudflare voici quelques commandes utiles. À noter, il est nécessaire que le proxy soit activé.

Si votre serveur ne dispose que de l'IPv4 :

```bash
for i in `curl -s https://www.cloudflare.com/ips-v4`; do iptables -I INPUT -p tcp -s $i --dport http -j ACCEPT; done
for i in `curl -s https://www.cloudflare.com/ips-v4`; do iptables -I INPUT -p tcp -s $i --dport https -j ACCEPT; done
```

Et si votre serveur dispose de l'IPv6, il sera nécessaire d'appliquer ces deux filtres supplémentaires.
```bash
for i in `curl -s https://www.cloudflare.com/ips-v6`; do ip6tables -I INPUT -p tcp -s $i --dport http -j ACCEPT; done
for i in `curl -s https://www.cloudflare.com/ips-v6`; do ip6tables -I INPUT -p tcp -s $i --dport https -j ACCEPT; done
```

C'est quelques lignes télécharge depuis le site web de Cloudflare leur adresse IP. Et pour ceux et celles qui ne connaissent pas `iptables` joue le rôle de firewall. [Lien vers la page Wikipédia](https://fr.wikipedia.org/wiki/Iptables).

Il est nécessaire ensuite de bloqué l'accès à toute adresse IP autre que Cloudflare.
```bash
iptables -A INPUT -p tcp --dport http -j DROP
iptables -A INPUT -p tcp --dport https -j DROP
ip6tables -A INPUT -p tcp --dport http -j DROP
ip6tables -A INPUT -p tcp --dport https -j DROP
```

Pour appliquer ses filtres, il ne faut pas oublier d'appliquer les changements :
```bash
iptables-save
```